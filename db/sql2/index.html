<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title><meta charset="UTF-8"><meta name="generator" content="prezentprogramo 1.0 https://github.com/yoosofan/prezentprogramo"><link rel="stylesheet" href="css/hovercraft.css" media="all"><link rel="stylesheet" href="css/highlight.css" media="all"><link rel="stylesheet" href="css/style.css" media="all"><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script></head><body class="impress-not-supported"><div id="impress" data-width="1024" data-height="768" data-transition-duration="1000"><div class="step step-level-1" step="0" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="0" data-z="0"><h1 id="database-course">Database Course</h1><p>Ahmad Yoosofan</p><p>SQL 2</p><p>University of Kashan</p></div><div class="step step-level-1 t2c" step="1" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="1600" data-y="0" data-z="0"><h1 id="aggregation-functions">Aggregation Functions</h1><div><p class="rtl-h2">&#1580;&#1605;&#1593; &#1607;&#1605;&#1607;&#1620; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;(qty) &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;.</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>1600</p></td></tr></tbody></table></div><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sn</p></th><th><p>pn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>S1</p></td><td><p>P1</p></td><td><p>300</p></td></tr><tr><td><p>S1</p></td><td><p>P5</p></td><td><p>100</p></td></tr><tr><td><p>S2</p></td><td><p>P1</p></td><td><p>300</p></td></tr><tr><td><p>S2</p></td><td><p>P2</p></td><td><p>400</p></td></tr><tr><td><p>S4</p></td><td><p>P2</p></td><td><p>200</p></td></tr><tr><td><p>S4</p></td><td><p>P4</p></td><td><p>300</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="2" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="3200" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607;&#1620; s2 &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;.</p><div><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'S2'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>700</p></td></tr></tbody></table></div><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sn</p></th><th><p>pn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>S1</p></td><td><p>P1</p></td><td><p>300</p></td></tr><tr><td><p>S1</p></td><td><p>P5</p></td><td><p>100</p></td></tr><tr><td><p>S2</p></td><td><p>P1</p></td><td><p>300</p></td></tr><tr><td><p>S2</p></td><td><p>P2</p></td><td><p>400</p></td></tr><tr><td><p>S4</p></td><td><p>P2</p></td><td><p>200</p></td></tr><tr><td><p>S4</p></td><td><p>P4</p></td><td><p>300</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="3" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="4800" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1605;&#1578;&#1601;&#1575;&#1608;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;(&#1777;).</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln">5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln">6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>46</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="4" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="6400" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1605;&#1578;&#1601;&#1575;&#1608;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;(&#1778;).</p><pre class="highlight code sql substep number-lines"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">);</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="5" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="8000" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;  &#1605;&#1578;&#1601;&#1575;&#1608;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;(&#1779;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>46</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th><th><p>sn</p></th><th><p>city</p></th></tr></thead><tbody><tr><td><p>P1</p></td><td><p>12</p></td><td><p>S2</p></td><td><p>Paris</p></td></tr><tr><td><p>P2</p></td><td><p>17</p></td><td><p>S2</p></td><td><p>Paris</p></td></tr><tr><td><p>P2</p></td><td><p>17</p></td><td><p>S3</p></td><td><p>Paris</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="6" id="sum-sample-weight-paris-id" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="9600" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1605;&#1578;&#1601;&#1575;&#1608;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;(&#1780;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table><p class="substep rtl">&#1570;&#1740;&#1575; &#1575;&#1740;&#1606; &#1585;&#1575;&#1607; &#1581;&#1604; &#1570;&#1582;&#1585;&#1740; &#1576;&#1575; distinct &#1583;&#1585;&#1587;&#1578; &#1575;&#1587;&#1578;&#1567;</p><p class="substep"><a href="#/query-inside-from-id">&#1585;&#1575;&#1607; &#1581;&#1604; &#1583;&#1740;&#1711;&#1585;</a></p></div><div class="step step-level-1 t2c" step="7" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="11200" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1605;&#1578;&#1601;&#1575;&#1608;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;(&#1781;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
    </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>46</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
      </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="8" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="12800" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578; &#1593;&#1585;&#1590;&#1607;&#8204;&#1588;&#1583;&#1607; &#1576;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; qty &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>13800</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">qty</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>qty</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>300</p></td><td><p>12</p></td></tr><tr><td><p>p2</p></td><td><p>400</p></td><td><p>17</p></td></tr><tr><td><p>p2</p></td><td><p>200</p></td><td><p>17</p></td></tr></tbody></table></div><div class="step step-level-1" step="9" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="14400" data-y="0" data-z="0"><h1 id="average">Average</h1><p class="rtl-h2">&#1605;&#1740;&#1575;&#1606;&#1711;&#1740;&#1606; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">awg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><p class="rtl-h2">&#1605;&#1740;&#1575;&#1606;&#1711;&#1740;&#1606; &#1605;&#1602;&#1583;&#1575;&#1585; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;(qty) &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="w">
</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="10" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="16000" data-y="0" data-z="0"><p class="rtl-h1">&#1605;&#1740;&#1575;&#1606;&#1711;&#1740;&#1606; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1583;&#1585; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">awg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">city</span><span class="o">=</span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>awg</p></th></tr></thead><tbody><tr><td><p>14.5</p></td></tr></tbody></table></div><div class="step step-level-1" step="11" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="17600" data-y="0" data-z="0"><p class="rtl-h1">&#1605;&#1740;&#1575;&#1606;&#1711;&#1740;&#1606; &#1605;&#1602;&#1583;&#1575;&#1585; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740;(qty) &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1588;&#1607;&#1585; &#1662;&#1575;&#1585;&#1740;&#1587; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">paqt</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="p">;</span></pre></div><div class="step step-level-1" step="12" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="19200" data-y="0" data-z="0"><h1 id="count">Count</h1><p class="rtl-h2">&#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">awg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>awg</p></th></tr></thead><tbody><tr><td><p>8</p></td></tr></tbody></table><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">awg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>awg</p></th></tr></thead><tbody><tr><td><p>6</p></td></tr></tbody></table></div><div class="step step-level-1" step="13" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="20800" data-y="0" data-z="0"><h1 id="count-1">Count(*)</h1><p class="rtl-h2">&#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">awg</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>awg</p></th></tr></thead><tbody><tr><td><p>8</p></td></tr></tbody></table><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">city</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ccy</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>ccy</p></th></tr></thead><tbody><tr><td><p>8</p></td></tr></tbody></table><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="p">;</span><span class="w">

  </span><span class="c1">-- &#1607;&#1605;&#1607;&#1620; &#1585;&#1705;&#1608;&#1585;&#1583;&#1607;&#1575; &#1585;&#1575; &#1605;&#1740;&#8204;&#1588;&#1605;&#1575;&#1585;&#1583; &#1576;&#1607; &#1601;&#1740;&#1604;&#1583; &#1582;&#1575;&#1589;&#1740; &#1605;&#1585;&#1576;&#1608;&#1591; &#1606;&#1740;&#1587;&#1578;.</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>12</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="14" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="22400" data-y="0" data-z="0"><h1 id="count-distinct">count(distinct)</h1><p class="rtl-h1">&#1578;&#1593;&#1583;&#1575;&#1583; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">city</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ccy</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>ccy</p></th></tr></thead><tbody><tr><td><p>3</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>city</p></th></tr></thead><tbody><tr><td><p>Oslo</p></td></tr><tr><td><p>London</p></td></tr><tr><td><p>Paris</p></td></tr><tr><td><p>London</p></td></tr><tr><td><p>London</p></td></tr><tr><td><p>Paris</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="15" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="24000" data-y="0" data-z="0"><p class="rtl-h1">&#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1588;&#1605;&#1575;&#1585;&#1607;&#8204;&#1607;&#1575;&#1740; &#1578;&#1705;&#1585;&#1575;&#1585;&#1740; &#1585;&#1575; &#1606;&#1605;&#1740;&#8204;&#1588;&#1605;&#1575;&#1585;&#1583;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>4</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">sn</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>sn</p></th></tr></thead><tbody><tr><td><p>S1</p></td></tr><tr><td><p>S2</p></td></tr><tr><td><p>S3</p></td></tr><tr><td><p>S4</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="16" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="25600" data-y="0" data-z="0"><p class="rtl-h1">&#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1602;&#1591;&#1593;&#1607;&#1620; &#1602;&#1585;&#1605;&#1586;&#1740; &#1585;&#1575; &#1576;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;(qty) &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1781; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">scc</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">and</span><span class="w">
  </span><span class="n">p</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>scc</p></th></tr></thead><tbody><tr><td><p>3</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="17" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="27200" data-y="0" data-z="0"><p class="rtl-h1">&#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1583;&#1587;&#1578; &#1705;&#1605; &#1605;&#1602;&#1583;&#1575;&#1585; &#1740;&#1705;&#1740; &#1575;&#1586; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1781; &#1576;&#1575;&#1588;&#1583; &#1608; &#1593;&#1585;&#1590;&#1607;&#8204;&#1575;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1576;&#1607; &#1585;&#1606;&#1711; &#1602;&#1585;&#1605;&#1586; &#1606;&#1740;&#1586; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;(&#1777;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">csn</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="n">sn</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="k">intersect</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="n">sn</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w">
</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">csn</span><span class="w"> </span><span class="c1">-- May have error
</span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
      </span><span class="k">select</span><span class="w"> </span><span class="n">sname</span><span class="w">
      </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
      </span><span class="k">where</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="k">intersect</span><span class="w">
      </span><span class="k">select</span><span class="w"> </span><span class="n">sname</span><span class="w">
      </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
        </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
      </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="18" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="28800" data-y="0" data-z="0"><p class="rtl-h1">&#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1583;&#1587;&#1578; &#1705;&#1605; &#1605;&#1602;&#1583;&#1575;&#1585; &#1740;&#1705;&#1740; &#1575;&#1586; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1781; &#1576;&#1575;&#1588;&#1583; &#1608; &#1593;&#1585;&#1590;&#1607;&#8204;&#1575;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1576;&#1607; &#1585;&#1606;&#1711; &#1602;&#1585;&#1605;&#1586; &#1606;&#1740;&#1586; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;(&#1778;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">csn</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w">
          </span><span class="k">and</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">qty</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
      </span><span class="n">p</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>csn</p></th></tr></thead><tbody><tr><td><p>3</p></td></tr></tbody></table></div><div class="step step-level-1" step="19" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="30400" data-y="0" data-z="0"><h1 id="min">Min</h1><p class="rtl-h2">&#1705;&#1605;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wgt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">p</span><span class="w">
</span><span class="p">;</span><span class="w">
</span><span class="c1">--- &#1705;&#1605;&#1578;&#1585;&#1740;&#1606;</span></pre></div><div class="step step-level-1" step="20" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="32000" data-y="0" data-z="0"><h1 id="max">max</h1><p class="rtl-h2">&#1576;&#1740;&#1588;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wgt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">p</span><span class="w">
</span><span class="p">;</span><span class="w">
</span><span class="c1">--- &#1576;&#1740;&#1588;&#1578;&#1585;&#1740;&#1606;
--- &#1576;&#1607; &#1575;&#1740;&#1606;&#1607;&#1575; &#1578;&#1575;&#1576;&#1593; &#1578;&#1580;&#1605;&#1593;&#1740; &#1711;&#1601;&#1578;&#1607; &#1605;&#1740;&#8204;&#1588;&#1608;&#1583;. aggregation function</span></pre></div><div class="step step-level-1 t2c" step="21" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="33600" data-y="0" data-z="0"><h1 id="group-by">group by</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607;&#8204;&#1575;&#1606;&#1583;.</p><div><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">sn</span><span class="w">
</span><span class="p">;</span></pre><ul class="rtl-h2"><li class="substep">&#1576;&#1585; &#1662;&#1575;&#1740;&#1607;&#1620; &#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1583;&#1587;&#1578;&#1607;&#8204;&#1576;&#1606;&#1583;&#1740; &#1605;&#1740;&#8204;&#1705;&#1606;&#1583;</li><li class="substep">&#1587;&#1662;&#1587; &#1576;&#1585;&#1575;&#1740; &#1607;&#1585; &#1583;&#1587;&#1578;&#1607;</li><li class="substep">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1570;&#1606; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; (&#1705;&#1607; &#1576;&#1575; &#1570;&#1606; &#1711;&#1585;&#1608;&#1607;&#8204;&#1576;&#1606;&#1583;&#1740; &#1575;&#1606;&#1580;&#1575;&#1605; &#1588;&#1583;&#1607; &#1575;&#1587;&#1578;)</li></ul></div><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>sn</p></th><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>s1</p></td><td><p>1300</p></td></tr><tr><td><p>s2</p></td><td><p>700</p></td></tr><tr><td><p>s3</p></td><td><p>200</p></td></tr><tr><td><p>s4</p></td><td><p>900</p></td></tr><tr><td><p>s6</p></td><td><p>350</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="22" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="35200" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607; &#1588;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w">   </span><span class="n">sp</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="23" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="36800" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575; &#1608;&#1586;&#1606; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1778; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;</p><div><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="p">;</span></pre><p class="substep rtl-h2">&#1606;&#1582;&#1587;&#1578; &#1588;&#1585;&#1591; where &#1575;&#1593;&#1605;&#1575;&#1604; &#1605;&#1740;&#8204;&#1588;&#1608;&#1583; &#1587;&#1662;&#1587; &#1576;&#1585; &#1585;&#1608;&#1740; &#1585;&#1705;&#1608;&#1585;&#1583;&#1607;&#1575;&#1740; &#1576;&#1575;&#1602;&#1740;&#1605;&#1575;&#1606;&#1583;&#1607; &#1583;&#1587;&#1578;&#1607;&#8204;&#1576;&#1606;&#1583;&#1740; &#1575;&#1606;&#1580;&#1575;&#1605; &#1605;&#1740;&#8204;&#1588;&#1608;&#1583;.</p></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="24" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="38400" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575; &#1608;&#1586;&#1606; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1778; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;</p><pre class="highlight code sql"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="o">&gt;</span><span class="mi">12</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><p class="substep rtl-h2">&#1605;&#1575;&#1606;&#1606;&#1583; &#1662;&#1740;&#1588;&#1740;&#1606; &#1576;&#1575; &#1575;&#1740;&#1606; &#1578;&#1601;&#1575;&#1608;&#1578; &#1705;&#1607; &#1711;&#1585;&#1608;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1576;&#1585;&#1711;&#1585;&#1583;&#1575;&#1606;&#1583;&#1607; &#1605;&#1740;&#8204;&#1588;&#1608;&#1606;&#1583; &#1705;&#1607; &#1588;&#1585;&#1591; having &#1585;&#1575; &#1606;&#1740;&#1586; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqt</p></th></tr></thead><tbody><tr><td><p>p2</p></td><td><p>1350</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="25" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="40000" data-y="0" data-z="0"><p class="rtl-h1">&#1711;&#1575;&#1605; &#1576;&#1607; &#1711;&#1575;&#1605;</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqt</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="o">&gt;</span><span class="mi">12</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>s1</p></td><td><p>300</p></td></tr><tr><td><p>p1</p></td><td><p>s2</p></td><td><p>300</p></td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p2</p></td><td><p>s1</p></td><td><p>200</p></td></tr><tr><td><p>p2</p></td><td><p>s2</p></td><td><p>400</p></td></tr><tr><td><p>p2</p></td><td><p>s3</p></td><td><p>200</p></td></tr><tr><td><p>p2</p></td><td><p>s4</p></td><td><p>200</p></td></tr><tr><td><p>p2</p></td><td><p>s6</p></td><td><p>350</p></td></tr></tbody></table><div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p3</p></td><td><p>s1</p></td><td><p>400</p></td></tr></tbody></table><p>.</p><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p6</p></td><td><p>s1</p></td><td><p>100</p></td></tr></tbody></table></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p4</p></td><td><p>s1</p></td><td><p>200</p></td></tr><tr><td><p>p4</p></td><td><p>s4</p></td><td><p>300</p></td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sn</p></th><th><p>qty</p></th></tr></thead><tbody><tr><td><p>p5</p></td><td><p>s1</p></td><td><p>100</p></td></tr><tr><td><p>p5</p></td><td><p>s4</p></td><td><p>400</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="26" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="41600" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;</p><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="n">T</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">      </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T2</span><span class="w">
</span><span class="ln">10 </span><span class="w">      </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">11 </span><span class="w">        </span><span class="n">T2</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">12 </span><span class="w">        </span><span class="n">T2</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">13 </span><span class="w">        </span><span class="n">T2</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="ln">14 </span><span class="w">    </span><span class="p">)</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="p">)</span></pre><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="c1">-- Second solution
</span><span class="ln">10 </span><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pname</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln">12 </span><span class="w">  </span><span class="n">sp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T1</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln">13 </span><span class="w">  </span><span class="n">sp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T2</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">14 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">T1</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">15 </span><span class="w">  </span><span class="n">T2</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">16 </span><span class="w">  </span><span class="n">T2</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">T1</span><span class="p">.</span><span class="n">sn</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="27" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="43200" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583;(&#1777;)</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w"> </span><span class="c1">--wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="28" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="44800" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583;(&#1778;)</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="29" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="46400" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583;</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>city</p></th></tr></thead><tbody><tr><td><p>London</p></td></tr><tr><td><p>Oslo</p></td></tr><tr><td><p>Paris</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">  </span><span class="c1">--- &#1606;&#1575;&#1583;&#1585;&#1587;&#1578;
</span><span class="ln"> 2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="p">;</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="c1">-- &#1606;&#1575;&#1583;&#1585;&#1587;&#1578;
</span><span class="ln">10 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">13 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="30" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="48000" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1601;&#1602;&#1591; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;  &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583; &#1608; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583;</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>city</p></th></tr></thead><tbody><tr><td><p>London</p></td></tr><tr><td><p>Oslo</p></td></tr><tr><td><p>Paris</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">sn</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="31" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="49600" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583; &#1608; &#1580;&#1605;&#1593; &#1608;&#1586;&#1606;&#1740; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;&#1776; &#1576;&#1575;&#1588;&#1583;(I)</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">10 </span><span class="w">        </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">11 </span><span class="w">    </span><span class="p">)</span><span class="w">
</span><span class="ln">12 </span><span class="w">  </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln">13 </span><span class="w">  </span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">14 </span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="32" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="51200" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583; &#1608; &#1580;&#1605;&#1593; &#1608;&#1586;&#1606;&#1740; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1575;&#1586; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;&#1776; &#1576;&#1575;&#1588;&#1583;(II)</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">10 </span><span class="w">        </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">11 </span><span class="w">    </span><span class="p">)</span><span class="w">
</span><span class="ln">12 </span><span class="w">  </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln">13 </span><span class="w">  </span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">14 </span><span class="w"></span><span class="p">);</span></pre></div><div class="step step-level-1 t2c" step="33" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="52800" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575; &#1608;&#1586;&#1606; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1778; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="c1">-- same result
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="c1">-- wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="34" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="54400" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1607; &#1548; &#1583;&#1587;&#1578; &#1705;&#1605; &#1740;&#1705;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585;&#1608;&#1606; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585; &#1570;&#1606; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1576;&#1575;&#1588;&#1583;(I).</p><div><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">-- wrong answer
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">7 </span><span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">  </span><span class="c1">-- wrong answer
</span><span class="ln"> 2 </span><span class="c1"></span><span class="k">FROM</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="o">=</span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre></div><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">-- wrong answer
</span><span class="ln"> 2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="c1">-- Mohammad Javad Akbari
</span><span class="ln"> 6 </span><span class="c1"></span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">11 </span><span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="35" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="56000" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1607; &#1548; &#1583;&#1587;&#1578; &#1705;&#1605; &#1740;&#1705;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585;&#1608;&#1606; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585; &#1570;&#1606; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1576;&#1575;&#1588;&#1583;(II).</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">11 </span><span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln">10 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">p2</span><span class="w">
</span><span class="ln">11 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">12 </span><span class="w">      </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="ln">13 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">14 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">16 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="36" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="57600" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1607; &#1548; &#1583;&#1587;&#1578; &#1705;&#1605; &#1740;&#1705;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585;&#1608;&#1606; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585; &#1570;&#1606; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1576;&#1575;&#1588;&#1583;(III).</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">11 </span><span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln">10 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">p3</span><span class="w">
</span><span class="ln">11 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">12 </span><span class="w">      </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p3</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">13 </span><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">p3</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">p3</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="ln">14 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">16 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">17 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="37" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="59200" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1593;&#1585;&#1590;&#1607; &#1588;&#1583;&#1607; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607; (&#1740;&#1575; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;) &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;&#1776; &#1576;&#1575;&#1588;&#1583;</p><p class="substep rtl-h2">&#1583;&#1602;&#1578; &#1705;&#1606;&#1740;&#1583; &#1605;&#1580;&#1605;&#1608;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575;&#1740;&#1583; &#1578;&#1593;&#1583;&#1575;&#1583;  &#1583;&#1585; &#1608;&#1586;&#1606; &#1590;&#1585;&#1576; &#1588;&#1608;&#1583;</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">on</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="n">spj</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">13 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="38" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="60800" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1593;&#1585;&#1590;&#1607; &#1588;&#1583;&#1607; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607; (&#1608; &#1606;&#1607; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1607;&#1605;&#8204;&#1606;&#1575;&#1605;&#8204;&#1607;&#1575;&#1740;&#1588;) &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;&#1776; &#1576;&#1575;&#1588;&#1583;</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">on</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="n">spj</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">10 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">13 </span><span class="w"></span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">on</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">      </span><span class="n">spj</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="k">join</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">      </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">        </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln">10 </span><span class="w">        </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spj</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln">11 </span><span class="w">          </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="ln">12 </span><span class="w">      </span><span class="p">)</span><span class="w">
</span><span class="ln">13 </span><span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="ln">14 </span><span class="w">    </span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="w">
</span><span class="ln">15 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">16 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="39" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="62400" data-y="0" data-z="0"><p class="rtl-h1">&#1583;&#1587;&#1578;&#1607;&#8204;&#1576;&#1606;&#1583;&#1740; &#1583;&#1585; &#1740;&#1705; &#1711;&#1585;&#1608;&#1607;</p><pre class="highlight code sql"><span class="ln">1 </span><span class="c1">-- Totally wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pname</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="c1">-- having count(distinct pn) &gt; 1
</span><span class="ln">6 </span><span class="c1"></span><span class="p">;</span></pre><pre class="highlight code sql"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pname</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="c1">-- having count(distinct pn) &gt; 1
</span><span class="ln">5 </span><span class="c1"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="40" id="query-inside-from-id" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="64000" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1583;&#1587;&#1578;&#1616;&#8204;&#1705;&#1605; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1575;&#1586; &#1662;&#1575;&#1585;&#1740;&#1587; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;.</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>46</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th><th><p>sn</p></th><th><p>city</p></th></tr></thead><tbody><tr><td><p>P1</p></td><td><p>12</p></td><td><p>S2</p></td><td><p>Paris</p></td></tr><tr><td><p>P2</p></td><td><p>17</p></td><td><p>S2</p></td><td><p>Paris</p></td></tr><tr><td><p>P2</p></td><td><p>17</p></td><td><p>S3</p></td><td><p>Paris</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln">3 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="ln">5 </span><span class="w">      </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="p">;</span></pre><div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table></div></div><div class="step step-level-1 t2c" step="41" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="65600" data-y="0" data-z="0"><p class="rtl-h1">&#1580;&#1605;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1583;&#1587;&#1578;&#1616;&#8204;&#1705;&#1605; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1575;&#1586; &#1662;&#1575;&#1585;&#1740;&#1587; &#1606;&#1740;&#1586; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;.</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>46</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">swg</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln">3 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span><span class="w">
</span><span class="ln">5 </span><span class="w">      </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="ln">6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">7 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>swg</p></th></tr></thead><tbody><tr><td><p>29</p></td></tr></tbody></table><p class="substep"><a href="#/sum-sample-weight-paris-id">&#1576;&#1581;&#1579; &#1575;&#1589;&#1604;&#1740;</a></p></div><div class="step step-level-1 t2c" step="42" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="67200" data-y="0" data-z="0"><h1 id="limit">LIMIT</h1><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>city</p></th></tr></thead><tbody><tr><td><p>London</p></td></tr><tr><td><p>Oslo</p></td></tr><tr><td><p>Paris</p></td></tr></tbody></table><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="w">
</span><span class="k">limit</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>city</p></th></tr></thead><tbody><tr><td><p>London</p></td></tr><tr><td><p>Oslo</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="43" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="68800" data-y="0" data-z="0"><h1 id="scalar-value-i">Scalar value(I)</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1608;&#1586;&#1606; &#1570;&#1606;&#1607;&#1575; &#1575;&#1586; &#1605;&#1740;&#1575;&#1606;&#1711;&#1740;&#1606; &#1608;&#1586;&#1606; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1587;&#1578;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p2</p></td><td><p>17</p></td></tr><tr><td><p>p3</p></td><td><p>17</p></td></tr><tr><td><p>p6</p></td><td><p>19</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="44" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="70400" data-y="0" data-z="0"><h1 id="scalar-value-ii">Scalar value(II)</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1705;&#1605;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1585;&#1575; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="p">);</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr><tr><td><p>p5</p></td><td><p>12</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">  </span><span class="c1">-- Wrong
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="n">weight</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
    </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
    </span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="n">weight</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
    </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
    </span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">);</span></pre></div><div class="step step-level-1 t2c" step="45" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="72000" data-y="0" data-z="0"><h1 id="scalar-value-v">Scalar value(V)</h1><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">qt</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Paris'</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>qt</p></th></tr></thead><tbody><tr><td><p>P2</p></td><td><p>1</p></td></tr><tr><td><p>P5</p></td><td><p>1</p></td></tr><tr><td><p>P8</p></td><td><p>1</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="46" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="73600" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; (qty) &#1570;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;(&#1777;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span><span class="w">

</span><span class="c1">-- wrong</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="47" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="75200" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; (qty) &#1570;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;(&#1778;).</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr><tr><td><p>p7</p></td><td></td></tr><tr><td><p>p8</p></td><td></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="48" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="76800" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1608;&#1590;&#1593;&#1740;&#1578; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1583;&#1585;&#1608;&#1606; &#1588;&#1607;&#1585; &#1570;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1607; &#1607;&#1605;&#1585;&#1575;&#1607; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1576;&#1607; &#1578;&#1585;&#1578;&#1740;&#1576; &#1606;&#1586;&#1608;&#1604;&#1740; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1607; &#1606;&#1588;&#1575;&#1606; &#1583;&#1575;&#1583;&#1607; &#1588;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><div><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w">
</span><span class="ln">2 </span><span class="w">   </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">5 </span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sum_status</span><span class="p">,</span><span class="w">
</span><span class="ln">6 </span><span class="w">   </span><span class="n">city</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="c1">-- wrong</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">city</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">desc</span><span class="w"> </span><span class="c1">-- wrong</span></pre></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sum_status</p></th><th><p>city</p></th></tr></thead><tbody><tr><td><p>p6</p></td><td><p>40</p></td><td><p>London</p></td></tr><tr><td><p>p2</p></td><td><p>40</p></td><td><p>Paris</p></td></tr><tr><td><p>p3</p></td><td></td><td><p>Oslo</p></td></tr><tr><td><p>p4</p></td><td><p>40</p></td><td><p>London</p></td></tr><tr><td><p>p1</p></td><td><p>40</p></td><td><p>London</p></td></tr><tr><td><p>p5</p></td><td><p>40</p></td><td><p>Paris</p></td></tr><tr><td><p>p7</p></td><td><p>40</p></td><td><p>London</p></td></tr><tr><td><p>p8</p></td><td><p>40</p></td><td><p>Paris</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="49" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="78400" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1580;&#1605;&#1593; &#1578;&#1593;&#1583;&#1575;&#1583; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606;&#1607;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;.</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span><span class="w"> </span><span class="c1">-- wrong</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr><tr><td><p>p7</p></td><td></td></tr><tr><td><p>p8</p></td><td></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="50" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="80000" data-y="0" data-z="0"><h1 id="left-outer-join-i">Left Outer Join(I)</h1><div><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span></pre></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>sqty</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>600</p></td></tr><tr><td><p>p2</p></td><td><p>1350</p></td></tr><tr><td><p>p3</p></td><td><p>400</p></td></tr><tr><td><p>p4</p></td><td><p>500</p></td></tr><tr><td><p>p5</p></td><td><p>500</p></td></tr><tr><td><p>p6</p></td><td><p>100</p></td></tr><tr><td><p>p7</p></td><td></td></tr><tr><td><p>p8</p></td><td></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="51" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="81600" data-y="0" data-z="0"><h1 id="left-outer-join-ii">Left Outer Join(II)</h1><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln">2 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="52" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="83200" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1607;&#1605;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1607; &#1548; &#1583;&#1587;&#1578; &#1705;&#1605; &#1740;&#1705;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585;&#1608;&#1606; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585; &#1570;&#1606; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1576;&#1575;&#1588;&#1583;.</p><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">      </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w">
</span><span class="ln">11 </span><span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="53" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="84800" data-y="0" data-z="0"><h1 id="full-outer-join-i">Full Outer Join(I)</h1><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sqty</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">pn</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pn</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="54" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="86400" data-y="0" data-z="0"><h1 id="full-outer-join-ii">Full Outer Join(II)</h1><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"> </span><span class="c1">-- very different result</span></pre></div><div class="step step-level-1 t2c" step="55" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="88000" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1607;&#1605;&#1607;&#1620; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1585;&#1575; &#1583;&#1585; &#1705;&#1606;&#1575;&#1585; &#1606;&#1575;&#1605; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1705;&#1607; &#1607;&#1605;&#1588;&#1607;&#1585;&#1740; &#1570;&#1606;&#1607;&#1575; &#1607;&#1587;&#1578;&#1606;&#1583; &#1576;&#1606;&#1608;&#1740;&#1587;&#1740;&#1583; &#1608; &#1575;&#1711;&#1585; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1607;&#1605;&#1588;&#1607;&#1585;&#1740; &#1570;&#1606; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1606;&#1576;&#1608;&#1583; &#1606;&#1575;&#1605; &#1588;&#1607;&#1585; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; null &#1576;&#1740;&#1575;&#1740;&#1583;(I)</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">city</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w">  </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">--wrong
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w">  </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">--wrong
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">city</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w">  </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">--wrong
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w">  </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">right</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w">  </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="c1">--wrong
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="56" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="89600" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1607;&#1605;&#1607;&#1620; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1585;&#1575; &#1583;&#1585; &#1705;&#1606;&#1575;&#1585; &#1606;&#1575;&#1605; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1705;&#1607; &#1607;&#1605;&#1588;&#1607;&#1585;&#1740; &#1570;&#1606;&#1607;&#1575; &#1607;&#1587;&#1578;&#1606;&#1583; &#1576;&#1606;&#1608;&#1740;&#1587;&#1740;&#1583; &#1608; &#1575;&#1711;&#1585; &#1602;&#1591;&#1593;&#1607;&#8204;&#1575;&#1740; &#1607;&#1605;&#1588;&#1607;&#1585;&#1740; &#1570;&#1606; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1606;&#1576;&#1608;&#1583; &#1606;&#1575;&#1605; &#1588;&#1607;&#1585; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; null &#1576;&#1740;&#1575;&#1740;&#1583;(II)</p><div><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">scity</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">city</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">scity</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pcity</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="c1">--  wrong</span></pre></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>scity</p></th><th><p>pcity</p></th></tr></thead><tbody><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>Paris</p></td><td><p>Paris</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>London</p></td><td><p>London</p></td></tr><tr><td><p>Athens</p></td><td></td></tr><tr><td><p>&#1705;&#1575;&#1588;&#1575;&#1606;</p></td><td></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="57" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="91200" data-y="0" data-z="0"><h1 id="is-null-is-not-null">is null / is not null</h1><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">pname</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">sname</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">;</span></pre></div><div class="step step-level-1 t2c" step="58" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="92800" data-y="0" data-z="0"><h1 id="scalar-value-iii">Scalar value(III)</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1705;&#1605;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1585;&#1575; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;(I).</p><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="c1">-- wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p7</p></td><td></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="c1">-- wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="59" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="94400" data-y="0" data-z="0"><h1 id="scalar-value-iv">Scalar value(IV)</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1705;&#1605;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1585;&#1575; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;(II).</p><pre class="highlight code sql"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="c1">-- wrong
</span><span class="ln">2 </span><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr></tbody></table><pre class="highlight code sql substep"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr><tr><td><p>p5</p></td><td><p>12</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="60" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="96000" data-y="0" data-z="0"><h1 id="scalar-value-iv-1">Scalar value(IV)</h1><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607; &#1608; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1705;&#1605;&#1578;&#1585;&#1740;&#1606; &#1608;&#1586;&#1606; &#1585;&#1575; &#1583;&#1575;&#1588;&#1578;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;(III).</p><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">    </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">asc</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">limit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr><tr><td><p>p5</p></td><td><p>12</p></td></tr></tbody></table><pre class="highlight code sql"><span class="ln">1 </span><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="ln">4 </span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="w">
</span><span class="ln">5 </span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="ln">6 </span><span class="w">  </span><span class="p">)</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="p">;</span></pre><table cellpadding="0" cellspacing="0" class="smallerelementwithfullborder"><thead><tr><th><p>pn</p></th><th><p>weight</p></th></tr></thead><tbody><tr><td><p>p1</p></td><td><p>12</p></td></tr><tr><td><p>p5</p></td><td><p>12</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="61" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="97600" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1602;&#1591;&#1593;&#1575;&#1578; &#1608; &#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1711;&#1575;&#1606; &#1607;&#1605;&#1588;&#1607;&#1585;&#1740; &#1570;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;. &#1606;&#1740;&#1575;&#1586;&#1740; &#1606;&#1740;&#1587;&#1578; &#1570;&#1606; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1570;&#1606; &#1602;&#1591;&#1593;&#1607; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583;.</p><div><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pname</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="p">);</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pname</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="p">;</span></pre></div><table cellpadding="0" cellspacing="0" class="substep smallerelementwithfullborder"><thead><tr><th><p>pname</p></th><th><p>sn</p></th></tr></thead><tbody><tr><td><p>Nut</p></td><td><p>s1</p></td></tr><tr><td><p>Nut</p></td><td><p>s4</p></td></tr><tr><td><p>Bolt</p></td><td><p>s2</p></td></tr><tr><td><p>Bolt</p></td><td><p>s3</p></td></tr><tr><td><p>Screw</p></td><td><p>s1</p></td></tr><tr><td><p>Screw</p></td><td><p>s4</p></td></tr><tr><td><p>Cam</p></td><td><p>s2</p></td></tr><tr><td><p>Cam</p></td><td><p>s3</p></td></tr><tr><td><p>Cog</p></td><td><p>s1</p></td></tr><tr><td><p>Cog</p></td><td><p>s4</p></td></tr><tr><td><p>Nut</p></td><td><p>s1</p></td></tr><tr><td><p>Nut</p></td><td><p>s4</p></td></tr><tr><td><p>Bolt</p></td><td><p>s2</p></td></tr><tr><td><p>Bolt</p></td><td><p>s3</p></td></tr></tbody></table></div><div class="step step-level-1 t2c" step="62" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="99200" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575;&#1740;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607;&#8204;&#1607;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1593;&#1585;&#1590;&#1607; &#1588;&#1583;&#1607; &#1576;&#1585;&#1575;&#1740; &#1570;&#1606; &#1662;&#1585;&#1608;&#1688;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1776;&#1776; &#1576;&#1575;&#1588;&#1583;. &#1583;&#1602;&#1578; &#1705;&#1606;&#1740;&#1583; &#1605;&#1580;&#1605;&#1608;&#1593; &#1608;&#1586;&#1606; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575;&#1740;&#1583; qty &#1583;&#1585; weight &#1590;&#1585;&#1576; &#1588;&#1608;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w"> </span><span class="c1">-- &#1606;&#1575;&#1583;&#1585;&#1587;&#1578;
</span><span class="k">from</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
  </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="k">having</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w">  </span><span class="c1">-- &#1606;&#1575;&#1583;&#1585;&#1587;&#1578;
</span><span class="k">from</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w">
  </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w"> </span><span class="c1">-- &#1583;&#1585;&#1587;&#1578;
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w">
  </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">exits</span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="n">spj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">jn</span><span class="o">=</span><span class="n">j</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
</span><span class="k">having</span><span class="w"> </span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">jname</span><span class="w"> </span><span class="c1">-- &#1583;&#1585;&#1587;&#1578;
</span><span class="k">from</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="n">jn</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">spj</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w">
    </span><span class="n">j</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">jn</span><span class="p">)</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">exits</span><span class="p">(</span><span class="w">
    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="p">(</span><span class="n">spj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w">
    </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">jn</span><span class="o">=</span><span class="n">j</span><span class="p">.</span><span class="n">jn</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w">
  </span><span class="p">)</span><span class="w">
  </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">jn</span><span class="w">
  </span><span class="k">having</span><span class="w"> </span><span class="p">(</span><span class="n">weight</span><span class="o">*</span><span class="n">qty</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">100</span></pre></div><div class="step step-level-1 t2c" step="63" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="100800" data-y="0" data-z="0"><p class="rtl-h1">&#1606;&#1575;&#1605; &#1588;&#1607;&#1585;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1575;&#1578;&#1740; &#1585;&#1575; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1593;&#1585;&#1590;&#1607;&#8204;&#1705;&#1606;&#1606;&#1583;&#1607;&#8204;&#1575;&#1740; &#1576;&#1575; &#1608;&#1590;&#1593;&#1740;&#1578; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1607; &#1740;&#1705;&#1740; &#1575;&#1586; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585;&#1608;&#1606; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1583; &#1608; &#1605;&#1580;&#1605;&#1608;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1602;&#1591;&#1593;&#1607;&#8204;&#1607;&#1575;&#1740; &#1570;&#1606; &#1588;&#1607;&#1585;&#1607;&#1575; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1778;&#1776; &#1576;&#1575;&#1588;&#1583; &#1576;&#1607; &#1588;&#1585;&#1591;&#1740; &#1705;&#1607; &#1578;&#1593;&#1583;&#1575;&#1583; &#1602;&#1591;&#1593;&#1575;&#1578; &#1583;&#1585; &#1570;&#1606; &#1588;&#1607;&#1585; &#1602;&#1591;&#1593;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1576;&#1575;&#1588;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span></pre><p class="rtl substep">&#1662;&#1575;&#1587;&#1582; &#1606;&#1575;&#1583;&#1585;&#1587;&#1578;</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="k">exists</span><span class="p">(</span><span class="w">
  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
  </span><span class="k">from</span><span class="w"> </span><span class="n">s</span><span class="w">
  </span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">.</span><span class="n">sn</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w">
</span><span class="k">having</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">pn</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span></pre><p class="rtl substep">&#1662;&#1575;&#1587;&#1582; &#1583;&#1585;&#1587;&#1578;</p></div><div class="step step-level-1 t2c" step="64" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="102400" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575; &#1608;&#1586;&#1606; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1778; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583; &#1705;&#1607; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1583;&#1608; &#1593;&#1585;&#1590;&#1607; &#1705;&#1606;&#1606;&#1583;&#1607; &#1570;&#1606;&#1607;&#1575; &#1585;&#1575; &#1593;&#1585;&#1590;&#1607; &#1705;&#1585;&#1583;&#1607; &#1576;&#1575;&#1588;&#1606;&#1583;.</p><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span><span class="w">
</span><span class="k">having</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span></pre></div><div class="step step-level-1" step="65" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="104000" data-y="0" data-z="0"><p class="rtl-h1">&#1588;&#1605;&#1575;&#1585;&#1607;&#1620; &#1602;&#1591;&#1593;&#1575;&#1578; &#1576;&#1575; &#1608;&#1586;&#1606; &#1576;&#1740;&#1588;&#1578;&#1585; &#1575;&#1586; &#1777;&#1778; &#1585;&#1575; &#1607;&#1605;&#1585;&#1575;&#1607; &#1576;&#1575; &#1580;&#1605;&#1593; &#1593;&#1585;&#1590;&#1607;&#8204;&#1607;&#1575;&#1740; &#1607;&#1585; &#1705;&#1583;&#1575;&#1605; &#1576;&#1740;&#1575;&#1576;&#1740;&#1583;.</p><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">pn</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">natural</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">p</span><span class="w">
</span><span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">pn</span></pre></div><div class="step step-level-1" step="66" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="105600" data-y="0" data-z="0"><p>END</p></div></div><div id="slide-number" class="slide-number">
         1
      </div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/gotoSlide.js"></script><script type="text/javascript" src="js/hovercraft.js"></script><script type="text/javascript" src="js/MathJax/es5/tex-mml-chtml.js"></script><script type="text/javascript">
      document.getElementById("impress").addEventListener("impress:stepenter", update_slide_number, false);
    </script></body></html>